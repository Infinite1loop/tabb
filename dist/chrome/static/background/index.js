!function(define){var __define;"function"==typeof define&&(__define=define,define=null),function(t,r,s,i,o){var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a="function"==typeof n[i]&&n[i],l=a.cache||{},c="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function h(r,s){if(!l[r]){if(!t[r]){var o="function"==typeof n[i]&&n[i];if(!s&&o)return o(r,!0);if(a)return a(r,!0);if(c&&"string"==typeof r)return c(r);var u=Error("Cannot find module '"+r+"'");throw u.code="MODULE_NOT_FOUND",u}f.resolve=p,f.cache={};var d=l[r]=new h.Module(r);t[r][0].call(d.exports,f,d,d.exports,this)}return l[r].exports;function f(t){var r=f.resolve(t);return!1===r?{}:h(r)}function p(s){var i=t[r][1][s];return null!=i?i:s}}function u(t){this.id=t,this.bundle=h,this.exports={}}h.isParcelRequire=!0,h.Module=u,h.modules=t,h.cache=l,h.parent=a,h.register=function(r,s){t[r]=[function(t,r){r.exports=s},{}]},Object.defineProperty(h,"root",{get:function(){return n[i]}}),n[i]=h;for(var d=0;d<r.length;d++)h(r[d]);if(s){var f=h(s);"object"==typeof exports&&"undefined"!=typeof module?module.exports=f:"function"==typeof define&&define.amd?define(function(){return f}):o&&(this[o]=f)}}({"7CofY":[function(t,r,s){t("aa43ee1c62bc0700").register(JSON.parse('{"abzv4":"index.js","j9UIu":"offscreen.bf42e808.html","17yNY":"offscreen.07c5b12a.js"}'))},{aa43ee1c62bc0700:"aOnzl"}],aOnzl:[function(t,r,s){var i={};function o(t){for(var r=Object.keys(t),s=0;s<r.length;s++)i[r[s]]=t[r[s]]}function n(t){var r=i[t];if(null==r)throw Error("Could not resolve bundle with id "+t);return r}r.exports.register=o,r.exports.resolve=n},{}],kgW6q:[function(t,r,s){t("./messaging"),t("../../../background/index")},{"./messaging":"iG3ww","../../../background/index":"lSzt3"}],iG3ww:[function(t,r,s){var i=t("@parcel/transformer-js/src/esmodule-helpers.js"),o=t("~background/messages/action"),n=i.interopDefault(o),a=t("~background/messages/getTabs"),l=i.interopDefault(a),c=t("~background/messages/search"),h=i.interopDefault(c);globalThis.__plasmoInternalPortMap=new Map,chrome.runtime.onMessageExternal.addListener((t,r,s)=>{switch(t.name){case"action":(0,n.default)({sender:r,...t},{send:t=>s(t)});break;case"getTabs":(0,l.default)({sender:r,...t},{send:t=>s(t)});break;case"search":(0,h.default)({sender:r,...t},{send:t=>s(t)})}return!0}),chrome.runtime.onMessage.addListener((t,r,s)=>{switch(t.name){case"action":(0,n.default)({sender:r,...t},{send:t=>s(t)});break;case"getTabs":(0,l.default)({sender:r,...t},{send:t=>s(t)});break;case"search":(0,h.default)({sender:r,...t},{send:t=>s(t)})}return!0}),chrome.runtime.onConnect.addListener(function(t){globalThis.__plasmoInternalPortMap.set(t.name,t),t.onMessage.addListener(function(r){t.name})})},{"~background/messages/action":"ktPYv","~background/messages/getTabs":"jEcxN","~background/messages/search":"4he6T","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],ktPYv:[function(t,r,s){t("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(s),(0,t("../fulltextIndex").IndexService).getInstance();let i=async(t,r)=>{switch(t.body.action){case"switchTab":{let r={type:"findInPage",searchQuery:t.body.message};await chrome.tabs.sendMessage(t.body.tab.id,r);let s=await chrome.tabs.update(t.body.tab.id,{active:!0});await chrome.windows.update(s.windowId,{focused:!0});break}case"openBookmark":await chrome.tabs.create({url:t.body.url}),chrome.tabs.onUpdated.addListener(function r(s,i,o){if(s===o.id&&"complete"===i.status){chrome.tabs.onUpdated.removeListener(r);let s={type:"findInPage",searchQuery:t.body.query};chrome.tabs.sendMessage(o.id,s),chrome.tabs.update(o.id,{active:!0}),chrome.windows.update(o.windowId,{focused:!0})}});break;case"openHistory":{let r=await chrome.tabs.create({url:t.body.url});chrome.tabs.onUpdated.addListener(function s(i,o,n){if(i===r.id&&"complete"===o.status){chrome.tabs.onUpdated.removeListener(s);let i={type:"findInPage",searchQuery:t.body.query};chrome.tabs.sendMessage(r.id,i),chrome.tabs.update(r.id,{active:!0}),chrome.windows.update(r.windowId,{focused:!0})}});break}case"openOptionsPage":chrome.runtime.openOptionsPage();break;default:console.log("Unknown action"),r.send({})}};s.default=i},{"../fulltextIndex":"j70Oe","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],j70Oe:[function(t,r,s){var i=t("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(s),i.export(s,"IndexService",()=>c);var o=t("flexsearch/dist/module/document"),n=i.interopDefault(o);let a="xxffdb",l=["bookmark","history"];class c{constructor(){this.dbname=a,this.storenames=l;let t=indexedDB.open(a);for(let r of(t.onsuccess=r=>{t.result.close(),console.log(`${a} first database opened successfully.`);let s=indexedDB.deleteDatabase(a);s.onsuccess=()=>{console.log(`${a} database deleted successfully.`);let t=indexedDB.open(a,1);t.onupgradeneeded=r=>{for(let r of(console.log("Creating and upgrading database"),this.db=t.result,l))if(!this.db.objectStoreNames.contains(r)){console.log(`Creating [${r}] object store`);let t=this.db.createObjectStore(r,{keyPath:"id"});t.createIndex("by_url","url",{unique:!0}),t.createIndex("by_lastVisit","lastVisit")}},t.onsuccess=()=>{console.log(`${a} database created successfully.`),this.db=t.result,this.backfillIndexes()},t.onerror=()=>{console.error(`Failed to create ${a} database:`,t.error)}},s.onerror=()=>{console.error(`Failed to delete ${a} database:`,s.error)}},t.onerror=()=>{console.error(`Failed to open ${a} database:`,t.error)},this.indexes=new Map,l))this.indexes.set(r,new n.default({cache:100,document:{id:"id",store:["title","url","content"],index:["title","url","content"]},encode:t=>t.split("")}))}static getInstance(){return c.instance||(c.instance=new c),c.instance}async clear(t){return new Promise((r,s)=>{if(console.log(`Clearing store and index for: ${t}`),!this.db.objectStoreNames.contains(t)){console.error(`Object store ${t} not found.`),s(`Object store ${t} not found.`);return}let i=this.db.transaction([t],"readwrite"),o=i.objectStore(t),n=o.clear();n.onsuccess=()=>{console.log(`Successfully cleared store: ${t}`),this.indexes.has(t)&&(this.indexes.delete(t),console.log(`Successfully cleared index for: ${t}`)),r()},n.onerror=()=>{console.error(`Failed to clear store ${t}:`,n.error),s(n.error)}})}backfillIndexes(){for(let t of(console.log("Backfilling indexes..."),this.storenames)){let r=this.db.transaction([t],"readonly").objectStore(t),s=r.getAll();s.onsuccess=()=>{for(let r of s.result)this.indexes.get(t).add(r)},s.onerror=()=>{console.error(`Failed to backfill index for store ${t}.`,s.error)}}}async insert(t,r,s){return new Promise((r,i)=>{if(!this.db.objectStoreNames.contains(t)){console.error(`Object store ${t} not found.`),i(`Object store ${t} not found.`);return}let o=this.db.transaction([t],"readwrite"),n=o.objectStore(t);n.put(s),o.oncomplete=()=>{this.indexes.get(t).add(s),r()},o.onerror=()=>i(o.error)})}async delete(t,r){return new Promise((s,i)=>{if(!this.db.objectStoreNames.contains(t)){console.error(`Object store ${t} not found.`),i(`Object store ${t} not found.`);return}let o=this.db.transaction([t],"readwrite"),n=o.objectStore(t);n.delete(r),o.oncomplete=()=>{this.indexes.get(t).remove(r),s()},o.onerror=()=>i(o.error)})}async deleteByUrl(t,r){return new Promise(async(s,i)=>{if(!r){console.error("URL parameter is missing or empty."),i("URL parameter is missing or empty.");return}if(!this.db.objectStoreNames.contains(t)){console.error(`Object store ${t} not found.`),i(`Object store ${t} not found.`);return}let o=this.db.transaction([t],"readonly"),n=o.objectStore(t),a=n.index("by_url"),l=a.getKey(r);l.onsuccess=()=>{let o=l.result;void 0!==o?this.delete(t,Number(o)).then(s).catch(i):(console.error(`No entry found for url ${r} in store ${t}.`),i(`No entry found for url ${r} in store ${t}.`))},l.onerror=()=>i(l.error)})}async get(t,r){return new Promise((s,i)=>{let o=this.db.transaction([t],"readonly"),n=o.objectStore(t),a=n.get(r);a.onsuccess=()=>{s(a.result)},a.onerror=()=>i(a.error)})}async exists(t,r){return new Promise((s,i)=>{if(!this.db.objectStoreNames.contains(t)){console.error(`Object store ${t} not found.`),i(`Object store ${t} not found.`);return}let o=this.db.transaction([t],"readonly"),n=o.objectStore(t),a=n.index("by_url"),l=a.getKey(r);l.onsuccess=()=>{let t=l.result;s(void 0!==t)},l.onerror=()=>i(l.error)})}async search(t,r){let s=this.indexes.get(t),i=s.search(r,["title","url","content"]),o=new Map;for(let s of i)for(let i of s.result)if(!o.has(i)){let s=await this.get(t,i);if(s){let n=h(s.content,r);(n.includes(r)||s.url.includes(r)||s.title.includes(r))&&o.set(i,{id:s.id,url:s.url,title:s.title,desc:n,type:t})}}return Array.from(o.values())}async clearOldHistory(){let t=6048e5,r=Date.now()-t;return new Promise((t,s)=>{if(!this.db.objectStoreNames.contains("history")){console.error("Object store history not found."),s("Object store history not found.");return}let i=this.db.transaction(["history"],"readwrite"),o=i.objectStore("history"),n=o.index("by_lastVisit"),a=IDBKeyRange.upperBound(r),l=n.openCursor(a);l.onsuccess=r=>{let s=r.target.result;s?(console.debug(`Deleting history record id: ${s.value.id}, lastVisit: ${new Date(s.value.lastVisit)}`),s.delete(),this.indexes.get("history").remove(s.value.id),s.continue()):(console.log("History cleanup complete."),t())},l.onerror=()=>{console.error("Failed to clear old history records:",l.error),s(l.error)}})}}function h(t,r){let s=t.indexOf(r);if(-1===s)return"";let i=40,o=60,n=Math.max(0,s-i),a=Math.min(t.length,s+r.length+o);return t.length,n=t.lastIndexOf(" ",n)+1||n,a=-1===(a=t.indexOf(" ",a))?t.length:a,t.substring(n,a)}},{"flexsearch/dist/module/document":"jHtCY","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],jHtCY:[function(t,r,s){var i=t("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(s);var o=t("./index.js"),n=i.interopDefault(o);t("./type.js");var a=t("./cache.js"),l=i.interopDefault(a),c=t("./common.js"),h=t("./async.js"),u=i.interopDefault(h),d=t("./intersect.js"),f=t("./serialize.js"),p=t("./worker/index.js"),m=i.interopDefault(p);function g(t){let r;if(!(this instanceof g))return new g(t);let s=t.document||t.doc||t;this.tree=[],this.field=[],this.marker=[],this.register=(0,c.create_object)(),this.key=(r=s.key||s.id)&&y(r,this.marker)||"id",this.fastupdate=(0,c.parse_option)(t.fastupdate,!0),this.storetree=(r=s.store)&&!0!==r&&[],this.store=r&&(0,c.create_object)(),this.tag=(r=s.tag)&&y(r,this.marker),this.tagindex=r&&(0,c.create_object)(),this.cache=(r=t.cache)&&new l.default(r),t.cache=!1,this.worker=t.worker,this.async=!1,this.index=b.call(this,t,s)}function b(t,r){let s=(0,c.create_object)(),i=r.index||r.field||r;(0,c.is_string)(i)&&(i=[i]);for(let r=0,o,a;r<i.length;r++)o=i[r],(0,c.is_string)(o)||(a=o,o=o.field),a=(0,c.is_object)(a)?Object.assign({},t,a):t,this.worker&&(s[o]=new m.default(a),s[o].worker||(this.worker=!1)),this.worker||(s[o]=new n.default(a,this.register)),this.tree[r]=y(o,this.marker),this.field[r]=o;if(this.storetree){let t=r.store;(0,c.is_string)(t)&&(t=[t]);for(let r=0;r<t.length;r++)this.storetree[r]=y(t[r],this.marker)}return s}function y(t,r){let s=t.split(":"),i=0;for(let o=0;o<s.length;o++)0<=(t=s[o]).indexOf("[]")&&(t=t.substring(0,t.length-2))&&(r[i]=!0),t&&(s[i++]=t);return i<s.length&&(s.length=i),1<i?s:s[0]}function j(t,r){if((0,c.is_string)(r))t=t[r];else for(let s=0;t&&s<r.length;s++)t=t[r[s]];return t}function x(t,r,s,i,o){if(t=t[o],i===s.length-1)r[o]=t;else if(t){if((0,c.is_array)(t)){r=r[o]=Array(t.length);for(let o=0;o<t.length;o++)x(t,r,s,i,o)}else r=r[o]||(r[o]=(0,c.create_object)()),o=s[++i],x(t,r,s,i,o)}}function w(t,r,s,i,o,n,a,l){if(t=t[a]){if(i===r.length-1){if((0,c.is_array)(t)){if(s[i]){for(let r=0;r<t.length;r++)o.add(n,t[r],!0,!0);return}t=t.join(" ")}o.add(n,t,l,!0)}else if((0,c.is_array)(t))for(let a=0;a<t.length;a++)w(t,r,s,i,o,n,a,l);else a=r[++i],w(t,r,s,i,o,n,a,l)}}function k(t,r,s){let i=this.tagindex[t];i&&i.length}function _(t){let r=Array(t.length);for(let s=0,i;s<t.length;s++)i=t[s],r[s]={id:i,doc:this.store[i]};return r}s.default=g,g.prototype.add=function(t,r,s){if((0,c.is_object)(t)&&(t=j(r=t,this.key)),r&&(t||0===t)){if(!s&&this.register[t])return this.update(t,r);for(let i=0,o,n;i<this.field.length;i++)n=this.field[i],o=this.tree[i],(0,c.is_string)(o)&&(o=[o]),w(r,o,this.marker,0,this.index[n],t,o[0],s);if(this.tag){let i=j(r,this.tag),o=(0,c.create_object)();(0,c.is_string)(i)&&(i=[i]);for(let r=0,n,a;r<i.length;r++)if(!o[n=i[r]]&&(o[n]=1,a=this.tagindex[n]||(this.tagindex[n]=[]),(!s||!a.includes(t))&&(a[a.length]=t,this.fastupdate))){let r=this.register[t]||(this.register[t]=[]);r[r.length]=a}}if(this.store&&(!s||!this.store[t])){let s;if(this.storetree){s=(0,c.create_object)();for(let t=0,i;t<this.storetree.length;t++)i=this.storetree[t],(0,c.is_string)(i)?s[i]=r[i]:x(r,s,i,0,i[0])}this.store[t]=s||r}}return this},g.prototype.append=function(t,r){return this.add(t,r,!0)},g.prototype.update=function(t,r){return this.remove(t).add(t,r)},g.prototype.remove=function(t){if((0,c.is_object)(t)&&(t=j(t,this.key)),this.register[t]){for(let r=0;r<this.field.length&&(this.index[this.field[r]].remove(t,!this.worker),!this.fastupdate);r++);if(this.tag&&!this.fastupdate)for(let r in this.tagindex){let s=this.tagindex[r],i=s.indexOf(t);-1!==i&&(1<s.length?s.splice(i,1):delete this.tagindex[r])}this.store&&delete this.store[t],delete this.register[t]}return this},g.prototype.search=function(t,r,s,i){!s&&(!r&&(0,c.is_object)(t)?(s=t,t=""):(0,c.is_object)(r)&&(s=r,r=0));let o=[],n=[],a,l,h,u,f,p,m=0;if(s){if((0,c.is_array)(s))h=s,s=null;else{if(t=s.query||t,h=(a=s.pluck)||s.index||s.field,u=s.tag,l=this.store&&s.enrich,f="and"===s.bool,r=s.limit||r||100,p=s.offset||0,u&&((0,c.is_string)(u)&&(u=[u]),!t)){for(let t=0,s;t<u.length;t++)(s=k.call(this,u[t],r,p,l))&&(o[o.length]=s,m++);return m?o:[]}(0,c.is_string)(h)&&(h=[h])}}h||(h=this.field),f=f&&(1<h.length||u&&1<u.length);let g=!i&&(this.worker||this.async)&&[];for(let a=0,b,y,j;a<h.length;a++){let x;if(y=h[a],(0,c.is_string)(y)||(y=(x=y).field,t=x.query||t,r=x.limit||r,l=x.enrich||l),g){g[a]=this.index[y].searchAsync(t,r,x||s);continue}if(j=(b=i?i[a]:this.index[y].search(t,r,x||s))&&b.length,u&&j){let t=[],s=0;f&&(t[0]=[b]);for(let r=0,i,o;r<u.length;r++)i=u[r],(j=(o=this.tagindex[i])&&o.length)&&(s++,t[t.length]=f?[o]:o);s&&(j=(b=f?(0,d.intersect)(t,r||100,p||0):(0,d.intersect_union)(b,t)).length)}if(j)n[m]=y,o[m++]=b;else if(f)return[]}if(g){let i=this;return new Promise(function(o){Promise.all(g).then(function(n){o(i.search(t,r,s,n))})})}if(!m)return[];if(a&&(!l||!this.store))return o[0];for(let t=0,r;t<n.length;t++){if((r=o[t]).length&&l&&(r=_.call(this,r)),a)return r;o[t]={field:n[t],result:r}}return o},g.prototype.contain=function(t){return!!this.register[t]},g.prototype.get=function(t){return this.store[t]},g.prototype.set=function(t,r){return this.store[t]=r,this},g.prototype.searchCache=a.searchCache,g.prototype.export=f.exportDocument,g.prototype.import=f.importDocument,(0,u.default)(g.prototype)},{"./index.js":"cfRC4","./type.js":"7B17j","./cache.js":"a7Rli","./common.js":"h0Ena","./async.js":"2SLnS","./intersect.js":"8pJwK","./serialize.js":"3oRYM","./worker/index.js":"f5Nb9","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],cfRC4:[function(t,r,s){var i=t("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(s),t("./type.js");var o=t("./lang/latin/default.js"),n=t("./common.js"),a=t("./lang.js"),l=t("./global.js"),c=t("./async.js"),h=i.interopDefault(c),u=t("./intersect.js"),d=t("./cache.js"),f=i.interopDefault(d),p=t("./preset.js"),m=i.interopDefault(p),g=t("./serialize.js");function b(t,r){let s,i,c;if(!(this instanceof b))return new b(t);t?(s=(t=(0,m.default)(t)).charset,i=t.lang,(0,n.is_string)(s)&&(-1===s.indexOf(":")&&(s+=":default"),s=l.global_charset[s]),(0,n.is_string)(i)&&(i=l.global_lang[i])):t={};let h,u,d=t.context||{};this.encode=t.encode||s&&s.encode||o.encode,this.register=r||(0,n.create_object)(),this.resolution=h=t.resolution||9,this.tokenize=c=s&&s.tokenize||t.tokenize||"strict",this.depth="strict"===c&&d.depth,this.bidirectional=(0,n.parse_option)(d.bidirectional,!0),this.optimize=u=(0,n.parse_option)(t.optimize,!0),this.fastupdate=(0,n.parse_option)(t.fastupdate,!0),this.minlength=t.minlength||1,this.boost=t.boost,this.map=u?(0,n.create_object_array)(h):(0,n.create_object)(),this.resolution_ctx=h=d.resolution||1,this.ctx=u?(0,n.create_object_array)(h):(0,n.create_object)(),this.rtl=s&&s.rtl||t.rtl,this.matcher=(c=t.matcher||i&&i.matcher)&&(0,a.init_stemmer_or_matcher)(c,!1),this.stemmer=(c=t.stemmer||i&&i.stemmer)&&(0,a.init_stemmer_or_matcher)(c,!0),this.filter=(c=t.filter||i&&i.filter)&&(0,a.init_filter)(c),this.cache=(c=t.cache)&&new f.default(c)}function y(t,r,s,i,o){return s&&1<t?r+(i||0)<=t?s+(o||0):0|(t-1)/(r+(i||0))*(s+(o||0))+1:0}function j(t,r,s){return t=1===t.length?t[0]:(0,n.concat)(t),s||t.length>r?t.slice(s,s+r):t}function x(t,r,s,i){if(s){let o=i&&r>s;t=(t=t[o?r:s])&&t[o?s:r]}else t=t[r];return t}function w(t,r,s,i,o){let a=0;if((0,n.is_array)(t)){if(o){let s=t.indexOf(r);-1!==s?1<t.length&&(t.splice(s,1),a++):a++}else{o=Math.min(t.length,s);for(let n=0,l;n<o;n++)(l=t[n])&&(a=w(l,r,s,i,o),i||a||delete t[n])}}else for(let n in t)(a=w(t[n],r,s,i,o))||delete t[n];return a}s.default=b,b.prototype.append=function(t,r){return this.add(t,r,!0)},b.prototype.add=function(t,r,s,i){if(r&&(t||0===t)){if(!i&&!s&&this.register[t])return this.update(t,r);r=this.encode(""+r);let o=r.length;if(o){let i=(0,n.create_object)(),a=(0,n.create_object)(),l=this.depth,c=this.resolution;for(let h=0;h<o;h++){let u=r[this.rtl?o-1-h:h],d=u.length;if(u&&d>=this.minlength&&(l||!a[u])){let f=y(c,o,h),p="";switch(this.tokenize){case"full":if(2<d){for(let r=0;r<d;r++)for(let i=d;i>r;i--)if(i-r>=this.minlength){let n=y(c,o,h,d,r);p=u.substring(r,i),this.push_index(a,p,n,t,s)}break}case"reverse":if(1<d){for(let r=d-1;0<r;r--)if((p=u[r]+p).length>=this.minlength){let i=y(c,o,h,d,r);this.push_index(a,p,i,t,s)}p=""}case"forward":if(1<d){for(let r=0;r<d;r++)(p+=u[r]).length>=this.minlength&&this.push_index(a,p,f,t,s);break}default:if(this.boost&&(f=Math.min(0|f/this.boost(r,u,h),c-1)),this.push_index(a,u,f,t,s),l&&1<o&&h<o-1){let a=(0,n.create_object)(),c=this.resolution_ctx,d=u,f=Math.min(l+1,o-h);a[d]=1;for(let n=1;n<f;n++)if((u=r[this.rtl?o-1-h-n:h+n])&&u.length>=this.minlength&&!a[u]){a[u]=1;let r=y(c+(o/2>c?0:1),o,h,f-1,n-1),l=this.bidirectional&&u>d;this.push_index(i,l?d:u,r,t,s,l?u:d)}}}}}this.fastupdate||(this.register[t]=1)}}return this},b.prototype.push_index=function(t,r,s,i,o,a){let l=a?this.ctx:this.map;if((!t[r]||a&&!t[r][a])&&(this.optimize&&(l=l[s]),a?((t=t[r]||(t[r]=(0,n.create_object)()))[a]=1,l=l[a]||(l[a]=(0,n.create_object)())):t[r]=1,l=l[r]||(l[r]=[]),this.optimize||(l=l[s]||(l[s]=[])),(!o||!l.includes(i))&&(l[l.length]=i,this.fastupdate))){let t=this.register[i]||(this.register[i]=[]);t[t.length]=l}},b.prototype.search=function(t,r,s){!s&&(!r&&(0,n.is_object)(t)?t=(s=t).query:(0,n.is_object)(r)&&(s=r));let i=[],o,a,l,c=0;if(s&&(t=s.query||t,r=s.limit,c=s.offset||0,a=s.context,l=s.suggest),t&&1<(o=(t=this.encode(""+t)).length)){let r=(0,n.create_object)(),s=[];for(let n=0,a=0,c;n<o;n++)if((c=t[n])&&c.length>=this.minlength&&!r[c]){if(!this.optimize&&!l&&!this.map[c])return i;s[a++]=c,r[c]=1}o=(t=s).length}if(!o)return i;r||(r=100);let h=this.depth&&1<o&&!1!==a,d=0,f;h?(f=t[0],d=1):1<o&&t.sort(n.sort_by_length_down);for(let s,n;d<o;d++){if(n=t[d],h?(s=this.add_result(i,l,r,c,2===o,n,f),l&&!1===s&&i.length||(f=n)):s=this.add_result(i,l,r,c,1===o,n),s)return s;if(l&&d==o-1){let t=i.length;if(t){if(1===t)return j(i[0],r,c)}else{if(h){h=0,d=-1;continue}return i}}}return(0,u.intersect)(i,r,c,l)},b.prototype.add_result=function(t,r,s,i,o,n,a){let l=[],c=a?this.ctx:this.map;if(this.optimize||(c=x(c,n,a,this.bidirectional)),c){let r=0,h=Math.min(c.length,a?this.resolution_ctx:this.resolution);for(let t=0,u=0,d,f;t<h&&(!(d=c[t])||(this.optimize&&(d=x(d,n,a,this.bidirectional)),i&&d&&o&&((f=d.length)<=i?(i-=f,d=null):(d=d.slice(i),i=0)),!d||(l[r++]=d,!o||!((u+=d.length)>=s))));t++);if(r)return o?j(l,s,0):void(t[t.length]=l)}return!r&&l},b.prototype.contain=function(t){return!!this.register[t]},b.prototype.update=function(t,r){return this.remove(t).add(t,r)},b.prototype.remove=function(t,r){let s=this.register[t];if(s){if(this.fastupdate)for(let r=0,i;r<s.length;r++)(i=s[r]).splice(i.indexOf(t),1);else w(this.map,t,this.resolution,this.optimize),this.depth&&w(this.ctx,t,this.resolution_ctx,this.optimize);r||delete this.register[t],this.cache&&this.cache.del(t)}return this},b.prototype.searchCache=d.searchCache,b.prototype.export=g.exportIndex,b.prototype.import=g.importIndex,(0,h.default)(b.prototype)},{"./type.js":"7B17j","./lang/latin/default.js":"dAbKO","./common.js":"h0Ena","./lang.js":"9yhKC","./global.js":"Pat7n","./async.js":"2SLnS","./intersect.js":"8pJwK","./cache.js":"a7Rli","./preset.js":"lYnKF","./serialize.js":"3oRYM","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],"7B17j":[function(t,r,s){var i=t("@parcel/transformer-js/src/esmodule-helpers.js");function o(){this.cache=null,this.matcher=null,this.stemmer=null,this.filter=null}function n(){this.field=null,this.index=null}i.defineInteropFlag(s),i.export(s,"IndexInterface",()=>o),i.export(s,"DocumentInterface",()=>n),o.prototype.add,o.prototype.append,o.prototype.search,o.prototype.update,o.prototype.remove},{"@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],hbR2Q:[function(t,r,s){s.interopDefault=function(t){return t&&t.__esModule?t:{default:t}},s.defineInteropFlag=function(t){Object.defineProperty(t,"__esModule",{value:!0})},s.exportAll=function(t,r){return Object.keys(t).forEach(function(s){"default"===s||"__esModule"===s||r.hasOwnProperty(s)||Object.defineProperty(r,s,{enumerable:!0,get:function(){return t[s]}})}),r},s.export=function(t,r,s){Object.defineProperty(t,r,{enumerable:!0,get:s})}},{}],dAbKO:[function(t,r,s){var i=t("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(s),i.export(s,"rtl",()=>n),i.export(s,"tokenize",()=>a),i.export(s,"encode",()=>l),t("../../type.js");var o=t("../../lang.js");let n=!1,a="";function l(t){return(0,o.pipeline).call(this,(""+t).toLowerCase(),!1,o.regex_whitespace,!1)}s.default={encode:l,rtl:!1,tokenize:""}},{"../../type.js":"7B17j","../../lang.js":"9yhKC","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],"9yhKC":[function(t,r,s){var i=t("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(s),i.export(s,"pipeline",()=>n),i.export(s,"regex_whitespace",()=>a),i.export(s,"normalize",()=>c),i.export(s,"init_filter",()=>h),i.export(s,"init_stemmer_or_matcher",()=>u),i.export(s,"replace",()=>d),i.export(s,"regex",()=>f),i.export(s,"collapse",()=>p),i.export(s,"filter",()=>m),t("./type.js");var o=t("./common.js");function n(t,r,s,i){if(t&&(r&&(t=d(t,r)),this.matcher&&(t=d(t,this.matcher)),this.stemmer&&1<t.length&&(t=d(t,this.stemmer)),i&&1<t.length&&(t=p(t)),s||""===s)){let r=t.split(s);return this.filter?m(r,this.filter):r}return t}let a=/[\p{Z}\p{S}\p{P}\p{C}]+/u,l=/[\u0300-\u036f]/g;function c(t){return t.normalize&&(t=t.normalize("NFD").replace(l,"")),t}function h(t){let r=(0,o.create_object)();for(let s=0,i=t.length;s<i;s++)r[t[s]]=1;return r}function u(t,r){let s=(0,o.get_keys)(t),i=s.length,n=[],a="",l=0;for(let o=0,c,h;o<i;o++)(h=t[c=s[o]])?(n[l++]=f(r?"(?!\\b)"+c+"(\\b|_)":c),n[l++]=h):a+=(a?"|":"")+c;return a&&(n[l++]=f(r?"(?!\\b)("+a+")(\\b|_)":"("+a+")"),n[l]=""),n}function d(t,r){for(let s=0,i=r.length;s<i&&(t=t.replace(r[s],r[s+1]));s+=2);return t}function f(t){return RegExp(t,"g")}function p(t){let r="",s="";for(let i=0,o=t.length,n;i<o;i++)(n=t[i])!==s&&(r+=s=n);return r}function m(t,r){let s=t.length,i=[];for(let o=0,n=0;o<s;o++){let s=t[o];s&&!r[s]&&(i[n++]=s)}return i}},{"./type.js":"7B17j","./common.js":"h0Ena","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],h0Ena:[function(t,r,s){var i=t("@parcel/transformer-js/src/esmodule-helpers.js");function o(t,r){return void 0!==t?t:r}function n(t){let r=Array(t);for(let s=0;s<t;s++)r[s]=c();return r}function a(t){let r=Array(t);for(let s=0;s<t;s++)r[s]=[];return r}function l(t){return Object.keys(t)}function c(){return Object.create(null)}function h(t){return[].concat.apply([],t)}function u(t,r){return r.length-t.length}function d(t){return t.constructor===Array}function f(t){return"string"==typeof t}function p(t){return"object"==typeof t}function m(t){return"function"==typeof t}i.defineInteropFlag(s),i.export(s,"parse_option",()=>o),i.export(s,"create_object_array",()=>n),i.export(s,"create_arrays",()=>a),i.export(s,"get_keys",()=>l),i.export(s,"create_object",()=>c),i.export(s,"concat",()=>h),i.export(s,"sort_by_length_down",()=>u),i.export(s,"is_array",()=>d),i.export(s,"is_string",()=>f),i.export(s,"is_object",()=>p),i.export(s,"is_function",()=>m)},{"@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],Pat7n:[function(t,r,s){var i=t("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(s),i.export(s,"global_lang",()=>o),i.export(s,"global_charset",()=>n),i.export(s,"registerCharset",()=>a),i.export(s,"registerLanguage",()=>l);let o={},n={};function a(t,r){n[t]=r}function l(t,r){o[t]=r}},{"@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],"2SLnS":[function(t,r,s){var i=t("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(s),i.export(s,"default",()=>function(t){n(t,"add"),n(t,"append"),n(t,"search"),n(t,"update"),n(t,"remove")}),t("./type.js");var o=t("./common.js");function n(t,r){t[r+"Async"]=function(){let t;let s=this,i=arguments,n=i[i.length-1];(0,o.is_function)(n)&&(t=n,delete i[i.length-1]);let a=new Promise(function(t){setTimeout(function(){s.async=!0;let o=s[r].apply(s,i);s.async=!1,t(o)})});return t?(a.then(t),this):a}}},{"./type.js":"7B17j","./common.js":"h0Ena","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],"8pJwK":[function(t,r,s){var i=t("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(s),i.export(s,"intersect",()=>n),i.export(s,"intersect_union",()=>a);var o=t("./common.js");function n(t,r,s,i){let n=t.length,a=[],l,c,h=0;i&&(i=[]);for(let u=n-1;0<=u;u--){let d=t[u],f=d.length,p=(0,o.create_object)(),m=!l;for(let t=0;t<f;t++){let o=d[t],f=o.length;if(f)for(let t=0,d,g;t<f;t++)if(g=o[t],l){if(l[g]){if(!u){if(s)s--;else if(a[h++]=g,h===r)return a}(u||i)&&(p[g]=1),m=!0}if(i&&(d=(c[g]||0)+1,c[g]=d,d<n)){let t=i[d-2]||(i[d-2]=[]);t[t.length]=g}}else p[g]=1}if(i)l||(c=p);else if(!m)return[];l=p}if(i)for(let t=i.length-1,o,n;0<=t;t--){n=(o=i[t]).length;for(let t=0,i;t<n;t++)if(!l[i=o[t]]){if(s)s--;else if(a[h++]=i,h===r)return a;l[i]=1}}return a}function a(t,r){let s=(0,o.create_object)(),i=(0,o.create_object)(),n=[];for(let r=0;r<t.length;r++)s[t[r]]=1;for(let t=0,o;t<r.length;t++){o=r[t];for(let t=0,r;t<o.length;t++)s[r=o[t]]&&!i[r]&&(i[r]=1,n[n.length]=r)}return n}},{"./common.js":"h0Ena","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],a7Rli:[function(t,r,s){var i=t("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(s),i.export(s,"searchCache",()=>a),t("./type.js");var o=t("./common.js");function n(t){this.limit=!0!==t&&t,this.cache=(0,o.create_object)(),this.queue=[]}function a(t,r,s){(0,o.is_object)(t)&&(t=t.query);let i=this.cache.get(t);return i||(i=this.search(t,r,s),this.cache.set(t,i)),i}s.default=n,n.prototype.set=function(t,r){if(!this.cache[t]){let r=this.queue.length;r===this.limit?delete this.cache[this.queue[r-1]]:r++;for(let t=r-1;0<t;t--)this.queue[t]=this.queue[t-1];this.queue[0]=t}this.cache[t]=r},n.prototype.get=function(t){let r=this.cache[t];if(this.limit&&r){let r=this.queue.indexOf(t);if(r){let t=this.queue[r-1];this.queue[r-1]=this.queue[r],this.queue[r]=t}}return r},n.prototype.del=function(t){for(let r=0,s;r<this.queue.length;r++)s=this.queue[r],this.cache[s].includes(t)&&(this.queue.splice(r--,1),delete this.cache[s])}},{"./type.js":"7B17j","./common.js":"h0Ena","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],lYnKF:[function(t,r,s){var i=t("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(s),i.export(s,"default",()=>a);var o=t("./common.js");let n={memory:{charset:"latin:extra",resolution:3,minlength:4,fastupdate:!1},performance:{resolution:3,minlength:3,optimize:!1,context:{depth:2,resolution:1}},match:{charset:"latin:extra",tokenize:"reverse"},score:{charset:"latin:advanced",resolution:20,minlength:3,context:{depth:3,resolution:9}},default:{}};function a(t){if((0,o.is_string)(t))t=n[t];else{let r=t.preset;r&&(t=Object.assign({},r[r],t))}return t}},{"./common.js":"h0Ena","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],"3oRYM":[function(t,r,s){var i=t("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(s),i.export(s,"exportIndex",()=>a),i.export(s,"importIndex",()=>l),i.export(s,"exportDocument",()=>c),i.export(s,"importDocument",()=>h),t("./type.js");var o=t("./common.js");function n(t,r,s,i,o,n,a,l){setTimeout(function(){let c=t(s?s+"."+i:i,JSON.stringify(a));c&&c.then?c.then(function(){r.export(t,r,s,o,n+1,l)}):r.export(t,r,s,o,n+1,l)})}function a(t,r,s,i,a,l){let c,h,u=!0;switch(void 0===l&&(u=new Promise(t=>{l=t})),a||(a=0)){case 0:if(c="reg",this.fastupdate)for(let t in h=(0,o.create_object)(),this.register)h[t]=1;else h=this.register;break;case 1:c="cfg",h={doc:0,opt:this.optimize?1:0};break;case 2:c="map",h=this.map;break;case 3:c="ctx",h=this.ctx;break;default:void 0===s&&l&&l();return}return n(t,r||this,s,c,i,a,h,l),u}function l(t,r){if(r)switch((0,o.is_string)(r)&&(r=JSON.parse(r)),t){case"cfg":this.optimize=!!r.opt;break;case"reg":this.fastupdate=!1,this.register=r;break;case"map":this.map=r;break;case"ctx":this.ctx=r}}function c(t,r,s,i,o,a){let l;if(void 0===a&&(l=new Promise(t=>{a=t})),o||(o=0),i||(i=0),i<this.field.length){let s=this.field[i],n=this.index[s];r=this,setTimeout(function(){n.export(t,r,o?s:"",i,o++,a)||(i++,o=1,r.export(t,r,s,i,o,a))})}else{let r,l;switch(o){case 1:r="tag",l=this.tagindex,s=null;break;case 2:r="store",l=this.store,s=null;break;default:a();return}n(t,this,s,r,i,o,l,a)}return l}function h(t,r){if(r)switch((0,o.is_string)(r)&&(r=JSON.parse(r)),t){case"tag":this.tagindex=r;break;case"reg":this.fastupdate=!1,this.register=r;for(let t=0,s;t<this.field.length;t++)(s=this.index[this.field[t]]).register=r,s.fastupdate=!1;break;case"store":this.store=r;break;default:t=t.split(".");let s=t[0];t=t[1],s&&t&&this.index[s].import(t,r)}}},{"./type.js":"7B17j","./common.js":"h0Ena","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],f5Nb9:[function(require,module,exports){var parcelHelpers=require("@parcel/transformer-js/src/esmodule-helpers.js");parcelHelpers.defineInteropFlag(exports);var _commonJs=require("../common.js"),_handlerJs=require("./handler.js"),_handlerJsDefault=parcelHelpers.interopDefault(_handlerJs);let pid=0;function WorkerIndex(t){let r;if(!(this instanceof WorkerIndex))return new WorkerIndex(t);t?(0,_commonJs.is_function)(r=t.encode)&&(t.encode=r.toString()):t={};let s=(self||window)._factory;s&&(s=s.toString());let i="undefined"==typeof window&&self.exports,o=this;this.worker=create(s,i,t.worker),this.resolver=(0,_commonJs.create_object)(),this.worker&&(i?this.worker.on("message",function(t){o.resolver[t.id](t.msg),delete o.resolver[t.id]}):this.worker.onmessage=function(t){t=t.data,o.resolver[t.id](t.msg),delete o.resolver[t.id]},this.worker.postMessage({task:"init",factory:s,options:t}))}function register(t){WorkerIndex.prototype[t]=WorkerIndex.prototype[t+"Async"]=function(){let r;let s=this,i=[].slice.call(arguments),o=i[i.length-1];(0,_commonJs.is_function)(o)&&(r=o,i.splice(i.length-1,1));let n=new Promise(function(r){setTimeout(function(){s.resolver[++pid]=r,s.worker.postMessage({task:t,id:pid,args:i})})});return r?(n.then(r),this):n}}function create(factory,is_node_js,worker_path){let worker;try{worker=is_node_js?eval('new (require("worker_threads")["Worker"])(__dirname + "/node/node.js")'):factory?new Worker(URL.createObjectURL(new Blob(["onmessage="+(0,_handlerJsDefault.default).toString()],{type:"text/javascript"}))):new Worker((0,_commonJs.is_string)(worker_path)?worker_path:"worker/worker.js",{type:"module"})}catch(e){}return worker}exports.default=WorkerIndex,register("add"),register("append"),register("search"),register("update"),register("remove")},{"../common.js":"h0Ena","./handler.js":"fgSkF","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],fgSkF:[function(t,r,s){var i=t("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(s),i.export(s,"default",()=>function(t){t=t.data;let r=self._index,s=t.args,i=t.task;if("init"===i){let r=t.options||{},s=t.factory,i=r.encode;r.cache=!1,i&&0===i.indexOf("function")&&(r.encode=Function("return "+i)()),s?(Function("return "+s)()(self),self._index=new self.FlexSearch.Index(r),delete self.FlexSearch):self._index=new n.default(r)}else{let o=t.id,n=r[i].apply(r,s);postMessage("search"===i?{id:o,msg:n}:{id:o})}});var o=t("../index.js"),n=i.interopDefault(o)},{"../index.js":"cfRC4","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],jEcxN:[function(t,r,s){t("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(s);let i=async(t,r)=>{let s=await chrome.tabs.query({});s=s.filter(t=>t.url&&t.url.startsWith("http")),r.send(s)};s.default=i},{"@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],"4he6T":[function(t,r,s){t("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(s);var i=t("../fulltextIndex");let o=(0,i.IndexService).getInstance(),n=async(t,r)=>{switch(t.body.action){case"bookmark":let s=await o.search("bookmark",t.body.query);r.send(s.length>0?s:[]);break;case"history":let i=await o.search("history",t.body.query);r.send(i.length>0?i:[]);break;case"tab":let n={type:"search",searchQuery:t.body.query,searchId:0},a=await chrome.tabs.query({}),l=[];for(let t of a)if(t.id&&!t.active){let r=await new Promise(r=>{chrome.tabs.sendMessage(t.id,n,s=>{s&&s.matchFoundAnywhere?r({...s,id:t.id,favIconUrl:t.favIconUrl,title:t.title,type:"tab"}):r(null)})});r&&l.push(r)}l.sort((t,r)=>r.relevanceScore-t.relevanceScore),r.send(l);break;default:r.send([])}};s.default=n},{"../fulltextIndex":"j70Oe","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],lSzt3:[function(t,r,s){var i=t("@parcel/transformer-js/src/esmodule-helpers.js"),o=t("url:~offscreen.html"),n=i.interopDefault(o),a=t("@plasmohq/storage"),l=t("./fulltextIndex");let c=new a.Storage,h="",u=(0,l.IndexService).getInstance();chrome.runtime.onInstalled.addListener(async()=>{await c.set("isInited","false"),await y(),d()}),chrome.action.onClicked.addListener(async t=>{u.clearOldHistory();let r=await b();r.url.includes("chrome://")||r.url.includes("chrome.google.com")?(await chrome.tabs.create({url:"./newtab.html"}),h=r.url,await chrome.tabs.remove(r.id)):await chrome.tabs.sendMessage(r.id,{type:"toggle"}),await c.set("isInited","true")}),chrome.commands.onCommand.addListener(async t=>{if(console.log("ttttttttttt"),"open-tabb"===t){let t=await b();t.url.includes("chrome://")||t.url.includes("chrome.google.com")?(await chrome.tabs.create({url:"./newtab.html"}),h=t.url,await chrome.tabs.remove(t.id)):await chrome.tabs.sendMessage(t.id,{type:"toggle"})}}),chrome.bookmarks.onCreated.addListener(async(t,r)=>{if(console.debug(`Bookmark created: ${r.title}`),!u.exists("bookmark",r.url)){let t=await g(r.url);if(t){let s={id:Number(r.id),title:r.title,url:r.url,content:t};await u.insert("bookmark",Number(r.id),s)}}}),chrome.bookmarks.onRemoved.addListener(async(t,r)=>{console.debug(`Bookmark removed: ${t}`),await u.delete("bookmark",Number(t))}),chrome.history.onVisited.addListener(async t=>{if(console.debug(`History item visited: ${t.title}`),!u.exists("history",t.url)){let r=await g(t.url);if(r){let s={id:Number(t.id),title:t.title||"No Title",url:t.url,content:r,lastVisit:t.lastVisitTime};await u.insert("history",Number(t.id),s)}}}),chrome.history.onVisitRemoved.addListener(async t=>{if(console.debug("History items removed"),t.allHistory)await u.clear("history");else for(let r of t.urls)await u.deleteByUrl("history",r)});let d=async()=>{console.log("Tabb install, start initializing history|bookmark...");let t=await chrome.bookmarks.getTree();await f(t);let r=await chrome.history.search({text:""});await p(r),await c.set("inited","true")};async function f(t,r=10){console.log("Processing bookmarks...");let s=m(t,r);for(let t of s)await Promise.all(t.map(async t=>{if(t.url){console.log("process boolmark",t.url);try{let r=await g(t.url);if(r){let s={id:t.id,title:t.title,url:t.url,content:r};await u.insert("bookmark",t.id,s)}}catch(r){console.error(`Failed to process bookmark ${t.url}: ${r}`)}}else t.children&&await f(t.children,r)}));console.log("Bookmarks initialized")}async function p(t,r=10){console.log("Processing histories...");let s=m(t,r);for(let t of s)await Promise.all(t.map(async t=>{if(t.url)try{console.log("process history",t.url);let r=await g(t.url);if(r){let s={id:t.id,title:t.title||"No Title",url:t.url,content:r,lastVisit:t.lastVisitTime||Date.now()};await u.insert("history",t.id,s)}}catch(r){console.error(`Failed to process history ${t.url}: ${r}`)}}));console.log("Histories initialized")}function m(t,r){let s=[];for(let i=0;i<t.length;i+=r)s.push(t.slice(i,i+r));return s}async function g(t){if(t.startsWith("http://")||t.startsWith("https://")){let r=new AbortController,s=setTimeout(()=>r.abort(),5e3);try{let i=await fetch(t,{signal:r.signal}),o=i.headers.get("content-type");if(!i.ok||!o||!o.includes("text"))throw console.error(`HTTP error! ok: ${i.ok}, contentType: ${o}, response:`,i),Error(`HTTP error! status: ${i.status}`);clearTimeout(s);let n=await i.text(),a=await chrome.runtime.sendMessage({type:"convert-markdown",rawHtml:n});return a}catch(r){"AbortError"===r.name?console.error("Fetch aborted due to timeout:",t):console.error("Fetch error:",r)}}}let b=async()=>{let t={active:!0,currentWindow:!0},[r]=await chrome.tabs.query(t);return r};async function y(){try{await j()||await chrome.offscreen.createDocument({url:n.default,reasons:[chrome.offscreen.Reason.DOM_PARSER],justification:"reason for needing the document"})}catch(t){console.error("Error creating offscreen document: ",t)}}async function j(){let t=await clients.matchAll();return t.some(t=>t.url.endsWith(n.default))}},{"url:~offscreen.html":"90o4G","@plasmohq/storage":"8Qr17","./fulltextIndex":"j70Oe","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],"90o4G":[function(t,r,s){r.exports=t("7682870094d3282c").getBundleURL("abzv4")+"../../"+t("a20932f5d1660a64").resolve("j9UIu")},{"7682870094d3282c":"1Ksod",a20932f5d1660a64:"aOnzl"}],"1Ksod":[function(t,r,s){var i={};function o(t){var r=i[t];return r||(r=n(),i[t]=r),r}function n(){try{throw Error()}catch(r){var t=(""+r.stack).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^)\n]+/g);if(t)return a(t[2])}return"/"}function a(t){return(""+t).replace(/^((?:https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/.+)\/[^/]+$/,"$1")+"/"}function l(t){var r=(""+t).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^/]+/);if(!r)throw Error("Origin not found");return r[0]}s.getBundleURL=o,s.getBaseURL=a,s.getOrigin=l},{}],"8Qr17":[function(t,r,s){var i=t("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(s),i.export(s,"BaseStorage",()=>l),i.export(s,"Storage",()=>c);var o=t("pify"),n=i.interopDefault(o),a=()=>{try{let t=globalThis.navigator?.userAgent.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if("Chrome"===t[1])return 100>parseInt(t[2])||globalThis.chrome.runtime?.getManifest()?.manifest_version===2}catch{}return!1},l=class{#e;#t;get primaryClient(){return this.#t}#r;get secondaryClient(){return this.#r}#s;get area(){return this.#s}get hasWebApi(){try{return"u">typeof window&&!!window.localStorage}catch(t){return console.error(t),!1}}#i=new Map;#o;get copiedKeySet(){return this.#o}isCopied=t=>this.hasWebApi&&(this.allCopied||this.copiedKeySet.has(t));#n=!1;get allCopied(){return this.#n}getExtStorageApi=()=>globalThis.browser?.storage||globalThis.chrome?.storage;get hasExtensionApi(){try{return!!this.getExtStorageApi()}catch(t){return console.error(t),!1}}isWatchSupported=()=>this.hasExtensionApi;keyNamespace="";isValidKey=t=>t.startsWith(this.keyNamespace);getNamespacedKey=t=>`${this.keyNamespace}${t}`;getUnnamespacedKey=t=>t.slice(this.keyNamespace.length);constructor({area:t="sync",allCopied:r=!1,copiedKeyList:s=[]}={}){this.setCopiedKeySet(s),this.#s=t,this.#n=r;try{this.hasWebApi&&(r||s.length>0)&&(this.#r=window.localStorage)}catch{}try{this.hasExtensionApi&&(this.#e=this.getExtStorageApi(),a()?this.#t=(0,n.default)(this.#e[this.area],{exclude:["getBytesInUse"],errorFirst:!1}):this.#t=this.#e[this.area])}catch{}}setCopiedKeySet(t){this.#o=new Set(t)}rawGetAll=()=>this.#t?.get();getAll=async()=>Object.entries(await this.rawGetAll()).filter(([t])=>this.isValidKey(t)).reduce((t,[r,s])=>(t[this.getUnnamespacedKey(r)]=s,t),{});copy=async t=>{let r=void 0===t;if(!r&&!this.copiedKeySet.has(t)||!this.allCopied||!this.hasExtensionApi)return!1;let s=this.allCopied?await this.rawGetAll():await this.#t.get((r?[...this.copiedKeySet]:[t]).map(this.getNamespacedKey));if(!s)return!1;let i=!1;for(let t in s){let r=s[t],o=this.#r?.getItem(t);this.#r?.setItem(t,r),i||=r!==o}return i};rawGet=async t=>this.hasExtensionApi?(await this.#t.get(t))[t]:this.isCopied(t)?this.#r?.getItem(t):null;rawSet=async(t,r)=>(this.isCopied(t)&&this.#r?.setItem(t,r),this.hasExtensionApi&&await this.#t.set({[t]:r}),null);clear=async(t=!1)=>{t&&this.#r?.clear(),await this.#t.clear()};rawRemove=async t=>{this.isCopied(t)&&this.#r?.removeItem(t),this.hasExtensionApi&&await this.#t.remove(t)};removeAll=async()=>{let t=Object.keys(await this.rawGetAll());await Promise.all(t.map(this.rawRemove))};watch=t=>{let r=this.isWatchSupported();return r&&this.#a(t),r};#a=t=>{for(let r in t){let s=this.getNamespacedKey(r),i=this.#i.get(s)?.callbackSet||new Set;if(i.add(t[r]),i.size>1)continue;let o=(t,r)=>{if(r!==this.area||!t[s])return;let i=this.#i.get(s);if(!i)throw Error(`Storage comms does not exist for nsKey: ${s}`);Promise.all([this.parseValue(t[s].newValue),this.parseValue(t[s].oldValue)]).then(([t,s])=>{for(let o of i.callbackSet)o({newValue:t,oldValue:s},r)})};this.#e.onChanged.addListener(o),this.#i.set(s,{callbackSet:i,listener:o})}};unwatch=t=>{let r=this.isWatchSupported();return r&&this.#l(t),r};#l(t){for(let r in t){let s=this.getNamespacedKey(r),i=t[r],o=this.#i.get(s);o&&(o.callbackSet.delete(i),0===o.callbackSet.size&&(this.#i.delete(s),this.#e.onChanged.removeListener(o.listener)))}}unwatchAll=()=>this.#c();#c(){this.#i.forEach(({listener:t})=>this.#e.onChanged.removeListener(t)),this.#i.clear()}async getItem(t){return this.get(t)}async setItem(t,r){await this.set(t,r)}async removeItem(t){return this.remove(t)}},c=class extends l{get=async t=>{let r=this.getNamespacedKey(t),s=await this.rawGet(r);return this.parseValue(s)};set=async(t,r)=>{let s=this.getNamespacedKey(t),i=JSON.stringify(r);return this.rawSet(s,i)};remove=async t=>{let r=this.getNamespacedKey(t);return this.rawRemove(r)};setNamespace=t=>{this.keyNamespace=t};parseValue=async t=>{try{if(void 0!==t)return JSON.parse(t)}catch(t){console.error(t)}}}},{pify:"9arDK","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],"9arDK":[function(t,r,s){var i=t("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(s),i.export(s,"default",()=>a);let o=(t,r,s,i)=>function(...o){let n=r.promiseModule;return new n((n,a)=>{r.multiArgs?o.push((...t)=>{r.errorFirst?t[0]?a(t):(t.shift(),n(t)):n(t)}):r.errorFirst?o.push((t,r)=>{t?a(t):n(r)}):o.push(n);let l=this===s?i:this;Reflect.apply(t,l,o)})},n=new WeakMap;function a(t,r){r={exclude:[/.+(?:Sync|Stream)$/],errorFirst:!0,promiseModule:Promise,...r};let s=typeof t;if(!(null!==t&&("object"===s||"function"===s)))throw TypeError(`Expected \`input\` to be a \`Function\` or \`Object\`, got \`${null===t?"null":s}\``);let i=(t,s)=>{let i=n.get(t);if(i||(i={},n.set(t,i)),s in i)return i[s];let o=t=>"string"==typeof t||"symbol"==typeof s?s===t:t.test(s),a=Reflect.getOwnPropertyDescriptor(t,s),l=void 0===a||a.writable||a.configurable,c=r.include?r.include.some(t=>o(t)):!r.exclude.some(t=>o(t)),h=c&&l;return i[s]=h,h},a=new WeakMap,l=new Proxy(t,{apply(t,s,i){let n=a.get(t);if(n)return Reflect.apply(n,s,i);let c=r.excludeMain?t:o(t,r,l,t);return a.set(t,c),Reflect.apply(c,s,i)},get(t,s){let n=t[s];if(!i(t,s)||n===Function.prototype[s])return n;let c=a.get(n);if(c)return c;if("function"==typeof n){let s=o(n,r,l,t);return a.set(n,s),s}return n}});return l}},{"@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}]},["7CofY","kgW6q"],"kgW6q","parcelRequire9923"),globalThis.define=__define}(globalThis.define);